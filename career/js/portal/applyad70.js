function pickFile(e,t){var i=$PROT(e+"_file_"+t),a=$PROT(e+"_file_data_"+t);"undefined"!=typeof filepicker&&filepicker.pick({container:"window",services:["COMPUTER","DROPBOX","BOX","SKYDRIVE","URL"]},function(e){i.update(e.filename),i.show(),a.setValue(Object.toJSON(e))},function(){})}var ApplyForm=Class.create();ApplyForm.prototype={initialize:function(e,t){this._numApplications=e,this._debug=t,this._validationCallBack=null,this._submitCallBack=null,this.getFieldsFromDOM(),$$PROT(".submitButton").each(function(e){e.observe("click",this.onSubmitForm.bind(this))}.bind(this)),$$PROT(".checkBoxAnswer").each(function(e){var t=e.down("span"),i=e.down("input");t&&i&&(t.style.cursor="pointer",t.observe("click",function(){i.checked=!i.checked}.bind(this)))}.bind(this)),$$PROT("span.orPasteContents").each(function(e){e.show()}),$$PROT("div.fileFirst").each(function(e){var t=e,i=t.down("span").down("a"),a=e.next("div.fileSecond"),n=a.down("span").down("a"),l=t.previous("input");n.observe("click",function(){t.show(),a.hide(),l.value="first"}.bind(this)),i.observe("click",function(){t.hide(),a.show(),l.value="second"}.bind(this))}.bind(this)),$$PROT("input.filepickerIoHidden").each(function(e){e.setValue("")})},getFieldsFromDOM:function(){this._fields=$A([]);for(var e=0;e<this._numApplications;e++){var t=$PROT("fields_guid_"+e);if(t){var i=JSON.parse(t.value);i.each(function(t){t=$H(t),t.set("guid",e),this._fields.push(t)}.bind(this))}}},setValidationCallBack:function(e){this._validationCallBack=e},setSubmitCallBack:function(e){this._submitCallBack=e},getRowValue:function(e,t){var i=e.id.indexOf("_"),a=e.id.substring(i+1),n=a.indexOf("_"),l=$H({});if(l.set("applicationID",parseInt(e.id.substring(1,i))),l.set("fieldID",parseInt(a.substring(n+1))),l.set("prefix",l.get("applicationID")+"_field_"+l.get("fieldID")),"node"==t){var o=$F(l.get("prefix"));l.set("nodeValue",o.strip())}else if("checkbox"==t)l.set("nodeValue",$PROT(l.get("prefix")).checked);else if("multi"==t){for(var s=$A([]),r=$PROT(e).select("input"),u=0;u<r.length;++u){var d=$PROT(r[u]);d&&d.checked&&s.push(u)}l.set("nodeValue",s)}else if("file"==t){if($PROT(l.get("applicationID")+"_resume_on_file_"+l.get("fieldID")))return l.set("nodeValue",1),l;var c=$F(l.get("applicationID")+"_field_mode_"+l.get("fieldID"));if("first"==c){var o=$F(l.get("prefix"));l.set("nodeValue",o.strip())}else if("filepicker.io"===c){var h=$F(l.get("applicationID")+"_file_data_"+l.get("fieldID"));l.set("nodeValue",h.strip())}else{var o=$F(l.get("applicationID")+"_field_alternate_"+l.get("fieldID"));l.set("nodeValue",o.strip())}}return l},getTextValue:function(e){return this.getRowValue(e,"node").get("nodeValue")},getMultilineValue:function(e){return this.getRowValue(e,"node").get("nodeValue")},getCheckboxValue:function(e){return this.getRowValue(e,"checkbox").get("nodeValue")},getCheckboxesValue:function(e){return this.getRowValue(e,"multi").get("nodeValue")},getSelectValue:function(e){return this.getRowValue(e,"node").get("nodeValue")},getRadioValue:function(e){return this.getRowValue(e,"multi").get("nodeValue")},getDateValue:function(e){return this.getRowValue(e,"node").get("nodeValue")},getFileValue:function(e){return this.getRowValue(e,"file").get("nodeValue")},getWorkHistoryValue:function(e){var t=$A([]),i=this.getRowValue(e,"workhistory"),a=i.get("applicationID"),n=i.get("fieldID"),l=" div.input > div.row > div.input > ",o=l+"input",s=l+"select",r=l+"textarea",u="#r"+a+"_fieldContainer_"+n+o+","+s+","+r,d=$A($$PROT(u));return d.each(function(e){var i=$PROT(e).readAttribute("name").split("-"),a=i[0],n={},l=i[1];n.value=$F(e),n.required=!!e.parentNode.className.match("required"),"undefined"==typeof t[a]&&(t[a]={}),t[a][l]=n}),t},getPhoneNumberValue:function(e){var t=$(e).find("input[name*='number']").val();t=t.replace(/[^\d]+/g,"");var i=$(e).find("input[name*='extension']").val();return{number:t,extension:i}},validateWorkHistoryDate:function(e,t,i){var a=+e[0].value,n=+e[1].value,l=+t[0].value,o=+t[1].value;return i||a||n||l||o?a&&!n?!1:l&&!o?!1:l&&a&&(n>o||o===n&&l&&a&&a>l)?!1:!0:!0},onSubmitForm:function(e){this.getFieldsFromDOM();var t=$A([]),i=(e.element(),$PROT("PortalUIError"));i.update(),i.hide(),validationJson=JSON.parse(document.getElementById("validationJson").value),$$PROT(".formInputDatePicker").each(function(e){var i=e.getValue().strip();i.length>0&&!i.match(/^([0-9]{2}[\-\.\s\/]){2}[0-9]{2,4}$/)&&t.push(validationJson["Invalid date value. Please use ##-##-####."]||"Invalid date value. Please use ##-##-####.")}.bind(this)),$$PROT(".validateNumber").each(function(e){e.getValue().match(/[^\.\-0-9]/)&&t.push((validationJson["Your entry for"]||"Your entry for")+' "'+e.title+'" '+(validationJson['does not appear to be a valid number. Only use "." "-" and digits (0-9)']||'does not appear to be a valid number.  Only use "." "-" and digits (0-9)'))}.bind(this));for(var a=0;a<this._fields.length;a++){var n=$H(this._fields[a]),l=$PROT("r"+n.get("guid")+"_fieldContainer_"+n.get("id")),o=null;if(null!=l)switch(n.get("type")){case"DATE":this.getDateValue(l).length<=0&&t.push(n.get("title")+" "+(validationJson["is a required field"]||"is a required field"));break;case"NUMBER":o=this.getTextValue(l),o.length<=0&&t.push(n.get("title")+" "+(validationJson["is a required field"]||"is a required field"));break;case"TEXT":var s=n.get("column");-1!==s.indexOf("phone")?(o=this.getPhoneNumberValue(l),o.number.length<=0&&t.push(n.get("title")+" "+(validationJson["is a required field"]||"is a required field"))):(o=this.getTextValue(l),o.length<=0?t.push(n.get("title")+" "+(validationJson["is a required field"]||"is a required field")):n.get("title").match(/[Ee][\-\. ]?[Mm][Aa][Ii][Ll]/)&&!this.getTextValue(l).match(/.*\@.*[\.].*/)&&n.get("title").length<15&&t.push((validationJson["Your entry for"]||"Your entry for")+' "'+n.get("title")+'" '+(validationJson["does not appear to be a valid email address"]||"does not appear to be a valid email address")));break;case"FILE":this.getFileValue(l).length<=0&&t.push(n.get("title")+" "+(validationJson["is a required field"]||"is a required field"));break;case"MULTILINE":this.getMultilineValue(l).length<=0&&t.push(n.get("title")+" "+(validationJson["is a required field"]||"is a required field"));break;case"CHECKBOXES":this.getCheckboxesValue(l).length<=0&&t.push((validationJson["Please check at least one answer for"]||"Please check at least one answer for")+' "'+n.get("title")+'"');break;case"RADIO":this.getRadioValue(l).length<=0&&t.push((validationJson["Please check at least one answer for"]||"Please check at least one answer for")+' "'+n.get("title")+'"');break;case"CHECKBOX":0==this.getCheckboxValue(l)&&t.push((validationJson["To continue, you are required to check"]||"To continue, you are required to check")+' "'+n.get("title")+'"');break;case"SELECT":""==this.getSelectValue(l)&&t.push((validationJson["Please select a value for"]||"Please select a value for")+' "'+n.get("title")+'"');break;case"WORKHISTORY":var r=this.getWorkHistoryValue(l),u={jobTitle:"Job Title",companyName:"Company",startYear:"Start Year",startMonth:"Start Month",endYear:"End Year",endMonth:"End Month",startDate:"Start Date",endDate:"End Date",supervisor:"Supervisor",supervisorPhone:"Supervisor Phone",city:"City",state:"State",summary:"Summary",reasonForLeaving:"Reason for Leaving"},d=this;r.each(function(e){var i=[e.startMonth,e.startYear],a=[e.endMonth,e.endYear],n=e.startMonth.required,l=d.validateWorkHistoryDate(i,a,n);l||t.push(validationJson["Please check Start/End dates"]||"Please check Start/End dates");for(fieldTitle in e)if(-1===fieldTitle.search(/start|end/)&&e[fieldTitle].required&&""===e[fieldTitle].value.trim()){var o=validationJson["Please enter a value for"]||"Please enter a value for";o+=" "+(validationJson[u[fieldTitle]]||u[fieldTitle]),t.push(o)}})}}if(null!==this._validationCallBack){var c=this._validationCallBack();c!==!1&&c.each(function(e){t.push(e)}.bind(this))}if(t.length>0){i.update('<div class="title">'+(validationJson["Please correct the following problems:"]||"Please correct the following problems:")+"</div>");var h=new Element("ul");return t.each(function(e){h.insert(new Element("li").update(e+"."))}.bind(this)),i.insert(h),i.show(),e.stop(),document.body.scrollTop=document.documentElement.scrollTop=0,!1}return null!==this._submitCallBack?void this._submitCallBack():!0}};